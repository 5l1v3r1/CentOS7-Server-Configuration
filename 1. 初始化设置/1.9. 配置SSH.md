## 1.9. 配置SSH

### 1.9.1. 配置SSH服务器

CentOS默认安装OpenSSH，编辑`/etc/ssh/sshd_config`文件，做一些安全设置（根据需要修改）：

禁止root远程登录，将`PermitRootLogin`一行取消注释，并修改为：

`PermitRootLogin no`

禁止空密码登录：

```
PermitEmptyPasswords no
PasswordAuthentication yes
```

`systemctl restart sshd` # 重启服务以生效

firewalld防火墙设置（SSH默认端口22/TCP）：

```
firewall-cmd --add-service=ssh --permanent
firewall-cmd --reload
```

修改端口：

编辑`/etc/ssh/sshd_config`文件，`Port 22`取消注释，并添加一行想要使用的端口（不要和服务器其他常用端口冲突）如10000，则添加`Port 10000`，将对应的防火墙规则先添加好。运行`systemctl restart sshd`重启SSH后测试是否可以通过添加的端口连接。可以连接后将`Port 22`重新注释并重启SSH。

### 1.9.2. 配置SSH客户端

#### 1.9.2.1. CentOS客户端

`yum -y install openssh-clients`

使用普通用户连接到SSH服务器：

`ssh cent@dlp.srv.world` # `ssh [用户名@域名或IP]`

```
The authenticity of host 'dlp.srv.world (<no hostip for proxy command>)' can't be established.
ECDSA key fingerprint is xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:60:90:d8.
Are you sure you want to continue connecting (yes/no)? yes  # 输入yes确认
Warning: Permanently added 'dlp.srv.world' (ECDSA) to the list of known hosts.
cent@dlp.srv.world's password:  # 用户cent的密码
```

可以使用SSH在远程主机上执行命令，如下所示：

`ssh cent@dlp.srv.world "cat /etc/passwd"` # 在远程主机上执行`cat /etc/passwd`

```
cent@dlp.srv.world's password:
root:x:0:0:root:/root:/bin/bash
bin:x:1:1:bin:/bin:/sbin/nologin
...
...
postfix:x:89:89::/var/spool/postfix:/sbin/nologin
sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin
```

#### 1.9.2.2. Windows客户端

推荐[Xshell](http://www.netsarang.com/products/xsh_overview.html)，使用方法就不多说了。


















