## 6.2. PostgreSQL

PostgreSQL[官方网站](https://www.postgresql.org/)及官网的[yum安装方法](https://www.postgresql.org/download/linux/redhat/)

### 6.2.1. PostgreSQL 9.2

#### 6.2.1.1 安装PostgreSQL

`yum -y install postgresql-server`

`postgresql-setup initdb`

```
Initializing database ... OK
```

编辑`/var/lib/pgsql/data/postgresql.conf`文件：

```
# 如果允许从远程主机访问，取消注释并更改
listen_addresses = '*'

# 如果更改日志格式，取消注释并更改，下面的示例是[日期 用户 数据库 ***]格式
log_line_prefix = '%t %u %d '
```

```
systemctl start postgresql
systemctl enable postgresql
```

如果PostgreSQL用于远程主机，firewalld防火墙设置（PostgreSQL使用端口5432/TCP）：

```
firewall-cmd --add-service=postgresql --permanent
firewall-cmd --reload
```

设置PostgreSQL管理员用户的密码，添加一个用户并添加一个测试数据库：

`su - postgres`

```
-bash-4.2$ psql -c "alter user postgres with password 'password'"  # 设置密码
ALTER ROLE

-bash-4.2$ createuser cent # 添加数据库用户（“cent”为例）

-bash-4.2$ createdb testdb -O cent # 创建一个测试数据库（所有者是上面的用户“cent”）
```

以刚刚添加的用户身份登录系统并操作数据库作为测试操作：

`psql -l` # 显示数据库

```
                                  List of databases
   Name    |  Owner   | Encoding |   Collate   |    Ctype    |   Access privileges
-----------+----------+----------+-------------+-------------+-----------------------
 postgres  | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 |
 template0 | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 | =c/postgres    +
           |          |          |             |             | postgres=CTc/postgres
 template1 | postgres | UTF8     | en_US.UTF-8 | en_US.UTF-8 | =c/postgres    +
           |          |          |             |             | postgres=CTc/postgres
 testdb    | cent     | UTF8     | en_US.UTF-8 | en_US.UTF-8 |
(4 rows)
```

`psql testdb` # 连接到测试数据库

```
psql (9.2.13)
Type "help" for help.

# 设置密码
testdb=# alter user cent with password 'password';
ALTER ROLE

# 创建test表
testdb=# create table test ( no int,name text );
CREATE TABLE

# 插入测试数据
testdb=# insert into test (no,name) values (1,'cent');
INSERT 0 1

# 显示表
testdb=# select * from test;
 no | name
----+-------
  1 | cent
(1 row)

# 删除test表
testdb=# drop table test;
DROP TABLE

# 退出
testdb=# \q
```

`dropdb testdb` # 删除测试数据库









