## 附0.2. 设置密码规则

出于安全考虑，设置密码规则。

**设置密码最大有效期**（用户必须在指定天数内更改密码。此设置仅影响新创建用户，如果要为现有用户设置，需运行命令：`chage -M (days) (user)`）：

编辑`/etc/login.defs`文件：

```
# 密码最大有效期设置为60（天）
PASS_MAX_DAYS 60
```

**设置密码最小有效期**（两次修改密码的最小间隔时间。此设置仅影响新创建用户，如果要为现有用户设置，需运行命令：`chage -m (days) (user)`）：

编辑`/etc/login.defs`文件：

```
# 密码最小有效期设置为2（天）
PASS_MIN_DAYS 2
```

**设置到期前的警告天数**（此设置仅影响新创建用户，如果要为现有用户设置，需运行命令：`chage -W (days) (user)`）：

编辑`/etc/login.defs`文件：

```
# 设置警告天数为7（天）
PASS_WARN_AGE 7
```

**限制使用过去使用过的密码**：

编辑`/etc/pam.d/system-auth`文件：

```
# 禁止使用与过去5代相同的密码（remember=5）
password     sufficient     pam_unix.so sha512 shadow nullok try_first_pass use_authtok remember=5
```

**设置密码最小长度**（用户无法设置长度小于此参数的密码）：

`authconfig --passminlen=8 --update` # 设置密码最小长度为8

`grep "^minlen" /etc/security/pwquality.conf` # 该参数在此配置中设置

```
minlen = 8
```

**设置新密码所需的最小字符种类**（种类有：大写字母/小写字母/数字/其他）

`authconfig --passminclass=2 --update` # 设置新密码所需的最小字符种类为2

`grep "^minclass" /etc/security/pwquality.conf`

```
minclass = 2
```

**设置新密码允许连续相同字符的最大数量**：

`authconfig --passmaxrepeat=2 --update` # 设置允许连续相同字符的最大数量为2

`grep "^maxrepeat" /etc/security/pwquality.conf`

```
maxrepeat = 2
```

**设置新密码允许连续相同字符种类的最大数量**：

`authconfig --passmaxclassrepeat=4 --update` # 设置允许连续相同字符种类的最大数量为4

`grep "^maxclassrepeat" /etc/security/pwquality.conf`

```
maxclassrepeat = 4
```

**设置新密码中至少需要一个小写字符**：

`authconfig --enablereqlower --update`

`grep "^lcredit" /etc/security/pwquality.conf` # 如果要编辑该值，使用vi或其它编辑器进行编辑

```
lcredit = -1
```

**设置新密码中至少需要一个大写字符**：

`authconfig --enablerequpper --update`

`grep "^ucredit" /etc/security/pwquality.conf` # 如果要编辑该值，使用vi或其它编辑器进行编辑

```
ucredit = -1
```

**设置新密码中至少需要一位数字**：

`authconfig --enablereqdigit --update`

`grep "^dcredit" /etc/security/pwquality.conf` # 如果要编辑该值，使用vi或其它编辑器进行编辑

```
dcredit = -1
```

**设置新密码中至少需要一个其他字符**：

`authconfig --enablereqother --update`

`grep "^ocredit" /etc/security/pwquality.conf` # 如果要编辑该值，使用vi或其它编辑器进行编辑

```
ocredit = -1
```

**设置新密码中单调字符序列的最大长度**（如：“12345”，“fedcb”等）：

编辑`/etc/security/pwquality.conf`文件：

```
# 添加到最后
maxsequence = 3
```

**设置新密码中不能存在的旧密码中的字符个数**：

编辑`/etc/security/pwquality.conf`文件：

```
# 添加到最后
difok = 5
```

**检查新密码中是否包含超过三个来自用户密码条目的GECOS（用户的详细信息，如姓名，年龄，电话等）字段的字符**：

编辑`/etc/security/pwquality.conf`文件：

```
# 添加到最后
gecoscheck = 1
```

**设置新密码中不能包含在Ssace分隔列表中的单词**：

编辑`/etc/security/pwquality.conf`文件：

```
# 添加到最后
badwords = denywords1 denywords2 denywords3
```

**为新密码设置哈希/加密算法**（默认为sha512）：

`authconfig --test | grep hashing` # 显示当前算法

```
password hashing algorithm is md5
```

`authconfig --passalgo=sha512 --update` # 更改算法为sha512

`authconfig --test | grep hashing`

```
password hashing algorithm is sha512
```
