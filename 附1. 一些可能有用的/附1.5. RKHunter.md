## 附1.5. RKHunter

安装Rootkit检测工具[RKHunter](http://rkhunter.cvs.sourceforge.net/viewvc/rkhunter/rkhunter/files/README)。

`yum --enablerepo=epel -y install rkhunter` # 从EPEL安装

配置和使用RKHunter（为了定期检查，检查脚本安装在`cron.daily`目录下，每天由Cron执行）：

编辑`/etc/sysconfig/rkhunter`文件：

```
# 报告的收件人地址
MAILTO=root@localhost
# 如果指定“yes”，扫描更详细
DIAG_SCAN=no
```

`rkhunter --update` # 更新数据库

`rkhunter --propupd` # 更新系统文件属性

执行检查（`--sk`表示跳过按回车键，如果指定`--rwo`只显示警告）：

`rkhunter --check --sk`

```
[ Rootkit Hunter version 1.4.2 ]

Checking system commands...

  Performing 'strings' command checks
    Checking 'strings' command                               [ OK ]

  Performing 'shared libraries' checks
    Checking for preloading variables                        [ None found ]
    Checking for preloaded libraries                         [ None found ]
    Checking LD_LIBRARY_PATH variable                        [ Not found ]

  Performing file properties checks
    Checking for prerequisites                               [ OK ]
    /usr/sbin/adduser                                        [ OK ]
    /usr/sbin/chkconfig                                      [ OK ]
    /usr/sbin/chroot                                         [ OK ]
    /usr/sbin/depmod                                         [ OK ]
    /usr/sbin/fsck                                           [ OK ]

.....
.....

System checks summary
=====================

File properties checks...
    Files checked: 121
    Suspect files: 0

Rootkit checks...
    Rootkits checked : 365
    Possible rootkits: 0

Applications checks...
    All checks skipped

The system checks took: 1 minute and 35 seconds

All results have been written to the log file: /var/log/rkhunter/rkhunter.log

No warnings were found while checking the system.
```
